<project name="update agent zero" default="run">
	<property name="temp.dir" value="temp"/>
	<property name="lib.dir" value="lib"/>
	<property name="iter.url" value="http://azapi-test.googlecode.com/svn/trunk/bin/iteration" />

	<property name="ext.file" value="ext.zip"/>
	<property name="lib.file" value="lib.zip"/>

	<target name="temp-dir-check">
	    <condition property="temp.dir.exists">
	      <available file="${temp.dir}" type="dir"/>
	    </condition>
  	</target>

	<target name="create-temp-dir" depends="temp-dir-check" unless="temp.dir.exists">
	    <mkdir dir="${temp.dir}"/>
  	</target>  	

  	<target name="lib-dir-check">
	    <condition property="lib.dir.exists">
	      <available file="${lib.dir}" type="dir"/>
	    </condition>
  	</target>

	<target name="create-lib-dir" depends="lib-dir-check" unless="lib.dir.exists">
	    <mkdir dir="${lib.dir}"/>
  	</target>  	

	<target name="clean-temp" depends="create-temp-dir">
		 <delete verbose="true">
    		<fileset dir="${temp.dir}"/>
  		 </delete>
	</target>

	<target name="download-files" depends="clean-temp">
		<get src="${iter.url}/${ext.file}"
			dest="${temp.dir}/${ext.file}" verbose="true"/>
		<get src="${iter.url}/${lib.file}"
			dest="${temp.dir}/${lib.file}" verbose="true"/>	
	</target>

	<target name="clean-old" depends="create-lib-dir">
		<delete verbose="true">
    		<fileset dir="${lib.dir}"/>
  		 </delete>
	</target>

	<target name="extract-data" depends="clean-old">
		<unzip dest="${lib.dir}" >
			 <fileset dir="${temp.dir}">
        		<include name="**/*.zip"/>
    		</fileset>
		</unzip>
	</target>

	<target name="delete-temp">
		<delete verbose="true" dir="${temp.dir}" />
	</target>

	<target name="run" depends="download-files,extract-data,delete-temp" />

</project>